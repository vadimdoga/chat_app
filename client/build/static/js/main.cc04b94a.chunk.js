(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t){},103:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),c=n(42),r=n.n(c),o=(n(50),n(51),n(3)),i=n(4),l=n(7),u=n(6),m=n(8),p=n(2),d=(n(52),n(53)),h=function(){function e(){Object(o.a)(this,e)}return Object(i.a)(e,null,[{key:"randomPrime",value:function(e){for(var t=d.one.shiftLeft(e-1),n=d.one.shiftLeft(e).prev();;){var a=d.randBetween(t,n);if(a.isProbablePrime(256))return a}}},{key:"generate",value:function(e){var t,n,a,s=d(65537);do{t=this.randomPrime(e/2),n=this.randomPrime(e/2),a=d.lcm(t.prev(),n.prev())}while(d.gcd(s,a).notEquals(1)||t.minus(n).abs().shiftRight(e/2-100).isZero());return{e:s,n:t.multiply(n),d:s.modInv(a)}}},{key:"encrypt",value:function(e,t,n){return d(e).modPow(n,t)}},{key:"decrypt",value:function(e,t,n){return d(e).modPow(t,n)}},{key:"encode",value:function(e){var t=e.split("").map((function(e){return e.charCodeAt()})).join("");return d(t)}},{key:"decode",value:function(e){for(var t=e.toString(),n="",a=0;a<t.length;a+=2){var s=Number(t.substr(a,2));s<=30?(n+=String.fromCharCode(Number(t.substr(a,3))),a++):n+=String.fromCharCode(s)}return n}}]),e}(),b=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={msg:"",publicObject:Object},n.handleChange=n.handleChange.bind(Object(p.a)(n)),n.sendToServer=n.sendToServer.bind(Object(p.a)(n)),n.handleKey=n.handleKey.bind(Object(p.a)(n)),n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.setState({msg:e.target.value})}},{key:"handleKey",value:function(){this.props.socket.emit("typing",!0)}},{key:"componentDidMount",value:function(){var e=this;this.props.socket.on("publicKey",(function(t){e.setState({publicObject:t})}))}},{key:"sendToServer",value:function(e){if(e.preventDefault(),""!==this.state.msg){var t=h.encode(this.state.msg),n=Object.values(this.state.publicObject)[0],a=Object.values(this.state.publicObject)[1],s=h.encrypt(t,n,a);console.log("Encrypted message to server: "+s),this.props.socket.emit("msg",s),this.setState({msg:""})}}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("form",{onSubmit:this.sendToServer},s.a.createElement("input",{className:"input-text",type:"text",name:"input",value:this.state.msg,onChange:this.handleChange,onKeyPress:this.handleKey}),s.a.createElement("input",{className:"input-submit",type:"submit",value:"Send"})))}}]),t}(a.Component),v=n(19),f=n(43),y=n.n(f),g=(n(71),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).scrollToBottom=function(){n.messagesEnd.scrollIntoView()},n.state={messages:[],msgData:[],senderName:"",connectedUsers:0,typing:!1,typingName:[]},n.props.socket.on("received",(function(e){console.log("received");var t=Object.values(e)[0],a=Object.values(e)[1];console.log("Encrypted message from server: "+t),console.log("pbkey: "+n.props.publicKey),console.log("prkey: "+n.props.privateKey);var s=h.decrypt(t,n.props.privateKey,n.props.publicKey),c=h.decode(s);console.log("Decrypted message from server: "+c),n.setState((function(e){return{msgData:[].concat(Object(v.a)(e.msgData),[{message:c,sender:a}])}}))})),n.props.socket.on("sendName",(function(e){n.setState({senderName:e})})),n.props.socket.on("connectedUsers",(function(e){n.setState({connectedUsers:e})})),n.props.socket.on("typingTrue",(function(e){n.setState({typing:!0}),n.state.typingName.includes(e)||n.setState((function(t){return{typingName:[].concat(Object(v.a)(t.typingName),[e])}})),setTimeout((function(){n.setState({typing:!1})}),3e3)})),n.scrollToBottom=n.scrollToBottom.bind(Object(p.a)(n)),n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.scrollToBottom(),y.a.get("http://192.168.0.3:8080/chats").then((function(t){var n=t.data;e.setState({messages:n})}))}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){var e=this;return s.a.createElement("ul",{className:"chat-box"},s.a.createElement("div",{className:"chat-header"},s.a.createElement("p",{className:"name"},"Chat App"),s.a.createElement("p",{className:"connected"},"Connected: ",this.state.connectedUsers)),this.state.messages.map((function(t){return s.a.createElement("div",{className:e.state.senderName===t.sender?"flex-container-true":"flex-container-false",key:t._id},s.a.createElement("li",{className:e.state.senderName===t.sender?"chat-text-true":"chat-text-false"},t.message),s.a.createElement("span",{className:e.state.senderName===t.sender?"sender-hide":"sender"},t.sender))})),this.state.msgData.map((function(t,n){return s.a.createElement("div",{className:e.state.senderName===t.sender?"flex-container-true":"flex-container-false",key:n},s.a.createElement("li",{className:e.state.senderName===t.sender?"chat-text-true":"chat-text-false"},t.message),s.a.createElement("span",{className:e.state.senderName===t.sender?"sender-hide":"sender"},t.sender))})),this.state.typing?this.state.typingName.map((function(e){return s.a.createElement("div",null,s.a.createElement("span",{className:"sender"},e),s.a.createElement("span",{className:"dot"}),s.a.createElement("span",{className:"dot"}),s.a.createElement("span",{className:"dot"}))})):this.state.typingName.splice(this.state.typingName.indexOf(0)),s.a.createElement("div",{ref:function(t){e.messagesEnd=t}}))}}]),t}(a.Component)),E=(n(72),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={name:"",connectedUsers:!1},n.handelSubmit=n.handelSubmit.bind(Object(p.a)(n)),n.handleChange=n.handleChange.bind(Object(p.a)(n)),n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handelSubmit",value:function(e){var t=this;e.preventDefault(),this.props.socket.emit("userData",this.state.name),this.props.socket.on("availableNickname",(function(e){e?(document.getElementsByClassName("modal")[0].style.display="none",t.props.socket.emit("keys",{publicKey:t.props.publicKey,publicExp:t.props.publicExp})):t.setState({name:"This name is already used"})}))}},{key:"handleChange",value:function(e){this.setState({name:e.target.value})}},{key:"render",value:function(){return s.a.createElement("div",{className:"modal"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("form",{onSubmit:this.handelSubmit},s.a.createElement("h1",null,"What is your name?"),s.a.createElement("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleChange}),s.a.createElement("input",{type:"submit",value:"Submit"}))))}}]),t}(s.a.Component)),k=n(44),j=n.n(k).a.connect("http://192.168.0.3:8080"),O=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={publicKey:null,publicExp:null,privateKey:null},e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=h.generate(250);this.setState({publicKey:e.n,publicExp:e.e,privateKey:e.d}),console.log("Keys:"),console.log("Public Key: ",e.n.toString()),console.log("Private Key: ",e.d.toString()),console.log("Public Exponent ",e.e.toString())}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(E,{socket:j,publicKey:this.state.publicKey,publicExp:this.state.publicExp}),s.a.createElement(g,{socket:j,privateKey:this.state.privateKey,publicKey:this.state.publicKey}),s.a.createElement(b,{socket:j}))}}]),t}(s.a.Component);var N=function(){return s.a.createElement("div",{className:"App"},s.a.createElement(O,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},45:function(e,t,n){e.exports=n(103)},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){}},[[45,1,2]]]);
//# sourceMappingURL=main.cc04b94a.chunk.js.map